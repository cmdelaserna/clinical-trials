<!-- Doc: http://getskeleton.com/ -->
<!-- d3 data: https://www.d3-graph-gallery.com/graph/basic_datamanipulation.html  -->
 <!-- D3 FILES & FLASK DATA: http://www.mydatastack.com/flaskd3part1 -->
 <!-- Color pallete: https://gka.github.io/palettes/ -->

<!DOCTYPE html>
<html lang="en">
<head>

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  <title>Trials Explorer</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Scripts
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <!-- <script src="https://d3js.org/d3.v5.min.js"></script> -->
  <script src="{{ url_for('static', filename = 'd3js/d3.min.js') }}"></script>

  
  <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">


  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="stylesheet" href="../static/css/normalize.css">
  <link rel="stylesheet" href="../static/css/skeleton.css">
  <link rel="stylesheet" href="../static/css/main.css">

  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <!-- <link rel="icon" type="image/png" href="images/favicon.png"> -->

</head>
<body>

  <!-- Primary Page Layout
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <div class="container">
    <div class="row">
      <div class="twelve columns" style="margin-top: 3%">

  <!-- Form 
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
        <form action = "/result" method = "POST">
         <p>
          <input type = "text" name = "Search" id = "search-input" placeholder= "new search" />
          <input class = 'button' type = "submit" value = "submit" />
        </p>
        </form>
        </div>

  <!-- Results
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->

<!-- Summary
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->

 <div class="row">
        <div class="twelve columns">
          {% for key, value in search.items() %}
        <h3><strong>Health Reports</strong> <div class = "search_term">{{value}}</div></h3>
        <!-- <p><code>
         {{number}} entries, {{source_number}} sources
      </code></p> -->
         {% endfor %}
         <hr>
        </div>
      </div>


<!-- Graph: Timeline & Phases
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->

      <div class="twelve columns" id= 'summary'>
        {% for key, value in search.items() %}
        <p>
          Summary of <strong>{{number}} clinical trials </strong> by research phase and registration year.
        {% endfor %}
          <select class="u-pull-right" id="filter" style = 'min-width: 200px'>
            <option value="All Trials">All Trials</option>
            <option value="Recruiting">Recruiting</option>
          </select>
        </p>
        <p><div id="phase"></div></p>
        <p><div id="svgTimeline"></div></p>
        <small>Source: clinicaltrials.gov</small>
      <hr>
      </div>

<!-- row -->
</div>

<!-- d3 scripts
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
<script>

    // Data 1st chart
    const timeline = ({{ timeline | safe }});
    const timelineMax = d3.max(d3.values(timeline['All Trials']));
    const timelineDataYear = d3.keys(timeline['All Trials']);
    var timelineData = d3.values(timeline['All Trials']);

    // Data 2nd chart
    const phase = ({{ phase | safe }});
    const phaseMax = d3.max(d3.values(phase['All Trials']));
    const phaseKeys = d3.keys(phase['All Trials']); 
    let phaseData = d3.values(phase['All Trials']);

    // Query data
    // const tsv = ({{data_index | safe}});
    
</script>

<script src="{{ url_for('static', filename = 'charts/timeline.js') }}"></script>
<script src="{{ url_for('static', filename = 'charts/phase.js') }}"></script>

<script>
// Buttons
    // const buttonRecruiting = document.getElementById('recruiting');
    
    // buttonRecruiting.onclick = function() { 
    //   phaseData = d3.values(phase.recruiting_labels);
    //   console.log(phaseData);

    // };

</script>

<!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
</body>
</html>
